syntax = "proto3";

package redbox_services;

option csharp_namespace = "RedBoxServices";

import "google/protobuf/empty.proto";

import "Shared.proto";

message GrpcPermission {
  string name = 1;
  uint32 code = 2;
}

message GrpcRole {
  optional string id = 1; // optional | not used on creation
  repeated GrpcPermission permissions = 2;
  string description = 3;
  string name = 4;
}

message GrpcUser {
  optional string id = 1; // optional | Generated by MongoDB on user creation
  string name = 2;
  string surname = 3;
  string email = 4;
  string roleid = 5;
  optional bool isblocked = 8; // optional | Not sent on user creation
  optional bool isfaenabled = 9; // optional | For check in modifications
  string username = 10;
  repeated string chats = 11;
  string biography = 12;
  string pathtopic = 13;
}

message GrpcPasswordMod {
  string password = 1;
  optional string newpassword = 2;
  string token = 3;
}

message GrpcToken {
  string token = 1;
}

service GrpcUserServices {
  rpc CreateUser (GrpcUser) returns (shared.Result);
  rpc DeleteUser (GrpcUser) returns (shared.Result);
  rpc ModifyUser (GrpcUser) returns (shared.Result);
  rpc TokenCheck (GrpcToken) returns (shared.Result);
  rpc ModifyPassword (GrpcPasswordMod) returns (shared.Result);
  rpc PasswordReset (GrpcUser) returns (shared.Result);
  rpc FinalizeEmailChange (GrpcToken) returns (shared.Result);
  //TODO bulk operations
  rpc FAStateChange (GrpcUser) returns (shared.Result);
  rpc BlockStateChange (GrpcUser) returns (shared.Result);
}